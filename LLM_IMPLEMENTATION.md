# ü§ñ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `rig-core` –≤–µ—Ä—Å–∏–∏ 0.24** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏.

### –ü–æ—á–µ–º—É rig-core?

#### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è rig-core:

1. **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
   - –í—Å–µ —Ç–∏–ø—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
   - –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ IDE

2. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API**
   - –û–¥–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (Ollama, OpenAI, Anthropic, Gemini –∏ —Ç.–¥.)
   - –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –º–µ–∂–¥—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
   - –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

3. **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ streaming**
   - –ì–æ—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –æ—Ç–≤–µ—Ç–æ–≤
   - –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å streaming –≤ –±—É–¥—É—â–µ–º

4. **–õ—É—á—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
   - –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
   - –ß–µ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫

5. **–ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**
   - –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
   - –°–æ–æ–±—â–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

6. **–í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API**
   - –ù–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å HTTP –∑–∞–ø—Ä–æ—Å—ã
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
   - –£–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏

7. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**
   - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–æ–≤—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
   - –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π (function calling)

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å:

```rust
// src/llm/client.rs

// 1. –°–æ–∑–¥–∞–µ–º Ollama –∫–ª–∏–µ–Ω—Ç —á–µ—Ä–µ–∑ rig-core
let client = OllamaClient::new();  // –∏–ª–∏ ClientBuilder –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ URL

// 2. –ü–æ–ª—É—á–∞–µ–º completion –º–æ–¥–µ–ª—å
let comp_model = client.completion_model("llama2");

// 3. –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API
let request = CompletionRequest {
    preamble: Some("You are an expert PostgreSQL database architect...".to_string()),
    chat_history: OneOrMany::one(Message::User {
        content: OneOrMany::one(UserContent::text(prompt)),
    }),
    temperature: Some(0.1),
    max_tokens: Some(512),
    // ...
};

// 4. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
let response = comp_model.completion(request).await?;

// 5. –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç –∏–∑ –æ—Ç–≤–µ—Ç–∞
for content in response.choice.iter() {
    if let AssistantContent::Text(text) = content {
        // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç
    }
}
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å rig-core:

```
User Question
    ‚Üì
build_sql_generation_prompt()  // –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç —Å —Å—Ö–µ–º–æ–π –ë–î
    ‚Üì
LLMClient::generate_sql()
    ‚Üì
call_ollama_with_rig()  // rig-core API
    ‚îú‚îÄ OllamaClient::new()  // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
    ‚îú‚îÄ client.completion_model()  // –ü–æ–ª—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
    ‚îú‚îÄ CompletionRequest  // –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
    ‚îî‚îÄ comp_model.completion()  // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
    ‚Üì
clean_sql_response()  // –£–±–∏—Ä–∞–µ—Ç markdown, –ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã
    ‚Üì
validate_sql()  // –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —ç—Ç–æ —Ç–æ–ª—å–∫–æ SELECT
    ‚Üì
SQL Query ‚Üí Database
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

### –í–∞—Ä–∏–∞–Ω—Ç 1: rig-core ‚úÖ –¢–ï–ö–£–©–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

**–ü–ª—é—Å—ã:**
- ‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- ‚úÖ –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ OpenAI/Anthropic
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ streaming
- ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –õ—É—á—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (–Ω–æ –æ–ø—Ä–∞–≤–¥–∞–Ω–∞)

**–ö–æ–¥:**
```rust
// –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ src/llm/client.rs
use rig::providers::ollama::Client as OllamaClient;
use rig::completion::CompletionRequest;
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º–æ–π HTTP —á–µ—Ä–µ–∑ reqwest (—Å—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥)

**–ü–ª—é—Å—ã:**
- ‚úÖ –ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∑–∞–ø—Ä–æ—Å–∞–º–∏

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã
- ‚ùå –ù–µ—Ç —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚ùå –°–ª–æ–∂–Ω–µ–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
- ‚ùå –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏

### –í–∞—Ä–∏–∞–Ω—Ç 3: ollama-rs (—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)

**–ü–ª—é—Å—ã:**
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è Ollama
- ‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π API

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –¢–æ–ª—å–∫–æ –¥–ª—è Ollama (–Ω–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ)
- ‚ùå –°–ª–æ–∂–Ω–µ–µ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

## –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏

–° `rig-core` –æ—á–µ–Ω—å –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –º–µ–∂–¥—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏:

### Ollama (—Ç–µ–∫—É—â–∏–π):
```env
LLM_PROVIDER=ollama
OLLAMA_URL=http://localhost:11434
OLLAMA_MODEL=llama2
```

### OpenAI (–±—É–¥—É—â–µ–µ):
```env
LLM_PROVIDER=openai
OPENAI_API_KEY=sk-...
```

–ö–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ç–µ–º –∂–µ, –º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞!

## –ö–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å?

### ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Ä–∞–±–æ—Ç–∞—é—Ç —Ö–æ—Ä–æ—à–æ)

```json
{"question": "–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π?"}
‚Üí SELECT COUNT(*) FROM transactions;

{"question": "–°–∫–æ–ª—å–∫–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±—ã–ª–æ —Å–µ–≥–æ–¥–Ω—è?"}
‚Üí SELECT COUNT(*) FROM transactions WHERE DATE(transaction_timestamp) = CURRENT_DATE;

{"question": "–¢–æ–ø 5 –º–µ—Ä—á–∞–Ω—Ç–æ–≤ –ø–æ –æ–±—ä–µ–º—É"}
‚Üí SELECT merchant_id, SUM(transaction_amount_kzt) as total 
  FROM transactions 
  WHERE transaction_type = 'POS' 
  GROUP BY merchant_id 
  ORDER BY total DESC 
  LIMIT 5;
```

### ‚úÖ –ó–∞–ø—Ä–æ—Å—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π (—Ä–∞–±–æ—Ç–∞—é—Ç —Ö–æ—Ä–æ—à–æ)

```json
{"question": "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –ê–ª–º–∞—Ç—ã"}
‚Üí SELECT * FROM transactions WHERE merchant_city ILIKE '%–∞–ª–º–∞—Ç—ã%';

{"question": "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ –∫–∞—Ä—Ç–∞–º Halyk Bank"}
‚Üí SELECT * FROM transactions WHERE issuer_bank_name ILIKE '%halyk%';

{"question": "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 'General Retail & Department'"}
‚Üí SELECT * FROM transactions WHERE mcc_category = 'General Retail & Department';
```

### ‚úÖ –ê–≥—Ä–µ–≥–∞—Ü–∏–∏ (—Ä–∞–±–æ—Ç–∞—é—Ç —Ö–æ—Ä–æ—à–æ)

```json
{"question": "–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≤ –ê–ª–º–∞—Ç—ã"}
‚Üí SELECT AVG(transaction_amount_kzt) as avg_amount 
  FROM transactions 
  WHERE merchant_city ILIKE '%–∞–ª–º–∞—Ç—ã%' 
  AND transaction_type = 'POS';

{"question": "–û–±—ä–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"}
‚Üí SELECT mcc_category, SUM(transaction_amount_kzt) as total 
  FROM transactions 
  WHERE transaction_type = 'POS' 
  GROUP BY mcc_category;
```

### ‚ö†Ô∏è –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å —É—Ç–æ—á–Ω–µ–Ω–∏—è)

```json
{"question": "–°—Ä–∞–≤–Ω–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ –±–∞–Ω–∫–∞–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü"}
‚Üí –ú–æ–∂–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞–º–∏

{"question": "–ü–æ–∫–∞–∂–∏ –¥–∏–Ω–∞–º–∏–∫—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –¥–Ω—è–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π"}
‚Üí –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É—Ç–æ—á–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –≤—ã–≤–æ–¥–∞
```

### ‚ùå –ß—Ç–æ –ù–ï –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

1. **–ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
   - "–£–¥–∞–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏" ‚Üí –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–º
   - "–û–±–Ω–æ–≤–∏ —Å—É–º–º—É" ‚Üí –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–º

2. **–°–ª–∏—à–∫–æ–º –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:**
   - "–ß—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ –≤ –¥–∞–Ω–Ω—ã—Ö?" ‚Üí –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ

3. **–ó–∞–ø—Ä–æ—Å—ã –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
   - "–ü–æ–∫–∞–∂–∏ –º–Ω–µ –¥–∞–Ω–Ω—ã–µ" ‚Üí –ö–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ –∑–∞–ø—Ä–æ—Å?

## –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü–æ –≤—Ä–µ–º–µ–Ω–∏:
- ‚úÖ "–°–∫–æ–ª—å–∫–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±—ã–ª–æ —Å–µ–≥–æ–¥–Ω—è?"
- ‚úÖ "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π"
- ‚úÖ "–û–±—ä–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ —è–Ω–≤–∞—Ä–µ 2024"
- ‚úÖ "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∑–∞ –≤—á–µ—Ä–∞"

### –ü–æ –º–µ—Ä—á–∞–Ω—Ç–∞–º:
- ‚úÖ "–¢–æ–ø 10 –º–µ—Ä—á–∞–Ω—Ç–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π"
- ‚úÖ "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –≥–æ—Ä–æ–¥–µ –ê–ª–º–∞—Ç—ã"
- ‚úÖ "–ú–µ—Ä—á–∞–Ω—Ç—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 'General Retail & Department'"

### –ü–æ –±–∞–Ω–∫–∞–º:
- ‚úÖ "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ –∫–∞—Ä—Ç–∞–º Halyk Bank"
- ‚úÖ "–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –¥–ª—è Kaspi Bank"
- ‚úÖ "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –±–∞–Ω–∫–∞–º"

### –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
- ‚úÖ "–û–±—ä–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º MCC"
- ‚úÖ "–¢–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π"
- ‚úÖ "–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 'Dining & Restaurants'"

### –ü–æ —Ç–∏–ø–∞–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:
- ‚úÖ "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ ATM_WITHDRAWAL —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π"
- ‚úÖ "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ POS –∏ ECOM —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π"
- ‚úÖ "P2P —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–≤—Ö–æ–¥—è—â–∏–µ –∏ –∏—Å—Ö–æ–¥—è—â–∏–µ)"
- ‚úÖ "BILL_PAYMENT —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"
- ‚úÖ "SALARY —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"

### –ü–æ –∫–æ—à–µ–ª—å–∫–∞–º:
- ‚úÖ "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ Apple Pay"
- ‚úÖ "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ Apple Pay –∏ Google Pay"
- ‚úÖ "–î–æ–ª—è –±–µ—Å–∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π"

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ:
- ‚úÖ "–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –¥–ª—è –∫–∞—Ä—Ç Halyk Bank –≤ –ê–ª–º–∞—Ç—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü"
- ‚úÖ "–¢–æ–ø 5 –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –æ–±—ä–µ–º—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —á–µ—Ä–µ–∑ Apple Pay"
- ‚úÖ "–î–Ω–µ–≤–Ω–æ–π –æ–±—ä–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 'General Retail & Department' –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π"

## –£–ª—É—á—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å

### 1. Streaming –æ—Ç–≤–µ—Ç–æ–≤

–° `rig-core` —ç—Ç–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ:

```rust
// rig-core –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç streaming –∏–∑ –∫–æ—Ä–æ–±–∫–∏
async fn generate_sql_streaming(&self, question: &str) -> impl Stream<Item = String> {
    let request = CompletionRequest { /* ... */ };
    let stream = comp_model.completion_stream(request).await?;
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–∞
}
```

### 2. Retry –ª–æ–≥–∏–∫–∞

```rust
async fn call_ollama_with_retry(&self, ...) -> Result<String> {
    for attempt in 1..=3 {
        match self.call_ollama_with_rig(...).await {
            Ok(result) => return Ok(result),
            Err(e) if attempt < 3 => {
                tokio::time::sleep(Duration::from_secs(attempt)).await;
                continue;
            }
            Err(e) => return Err(e),
        }
    }
}
```

### 3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤

```rust
use std::collections::HashMap;

struct LLMClient {
    cache: Arc<Mutex<HashMap<String, String>>>,
    // ...
}

// –ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
```

### 4. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ OpenAI

–û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ —Å `rig-core`:

```rust
// –í src/llm/client.rs —É–∂–µ –µ—Å—Ç—å –∑–∞–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è OpenAI
LLMProvider::OpenAI { api_key } => {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º rig::providers::openai::Client
    // API –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–µ–º –∂–µ!
}
```

### 5. Function Calling

`rig-core` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç function calling:

```rust
let request = CompletionRequest {
    tools: vec![
        Tool {
            name: "execute_sql".to_string(),
            description: "Execute SQL query".to_string(),
            // ...
        }
    ],
    // ...
};
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```toml
# Cargo.toml
[dependencies]
rig-core = "0.24"  # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è LLM
```

## –ò—Ç–æ–≥

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å `rig-core` - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä** –ø–æ—Ç–æ–º—É —á—Ç–æ:

1. ‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
2. ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å - –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
3. ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ
4. ‚úÖ –ì–æ—Ç–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (streaming, function calling)
5. ‚úÖ –ß–∏—Å—Ç—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∏ —Ä–∞–∑–≤–∏–≤–∞—Ç—å –µ—ë –¥–∞–ª—å—à–µ, –¥–æ–±–∞–≤–ª—è—è –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
