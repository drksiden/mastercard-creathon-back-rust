# üí¨ Chat API Documentation

API –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–±—â–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–µ—Å—Å–∏–π –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

## Endpoint

```
POST /api/chat
```

## Request

```json
{
  "message": "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?",
  "session_id": "optional-session-id",  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω - —Å–æ–∑–¥–∞—Å—Ç—Å—è –Ω–æ–≤—ã–π
  "user_id": "optional-user-id"         // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "anonymous"
}
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- `message` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `session_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): ID —Å–µ—Å—Å–∏–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π
- `user_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é "anonymous"

## Response

```json
{
  "message": "–ü—Ä–∏–≤–µ—Ç! –£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ! üòä –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?",
  "session_id": "550e8400-e29b-41d4-a716-446655440000",
  "response_time_ms": 234
}
```

### –ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞

- `message`: –û—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- `session_id`: ID —Å–µ—Å—Å–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- `response_time_ms`: –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### üåç –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Ç–æ–º –∂–µ —è–∑—ã–∫–µ:
- üá∑üá∫ –†—É—Å—Å–∫–∏–π
- üá¨üáß –ê–Ω–≥–ª–∏–π—Å–∫–∏–π  
- üá∞üáø –ö–∞–∑–∞—Ö—Å–∫–∏–π

### üí¨ –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Å–µ—Å—Å–∏–∏

- –ö–∞–∂–¥–∞—è —Å–µ—Å—Å–∏—è —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Å–æ–æ–±—â–µ–Ω–∏–π
- –°–µ—Å—Å–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω `session_id` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

### üòä –°—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è

- –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π
- –£–º–µ—Ä–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–º–∞–π–ª–∏–∫–æ–≤ (1-2 –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ)
- –ü–æ–º–æ—â—å —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏)

```bash
curl -X POST http://localhost:3000/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "–ü—Ä–∏–≤–µ—Ç! –†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ"
  }'
```

–û—Ç–≤–µ—Ç:
```json
{
  "message": "–ü—Ä–∏–≤–µ—Ç! –Ø –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. üòä –ú–æ–≥—É –ø–æ–º–æ—á—å —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –æ –¥–∞–Ω–Ω—ã—Ö, –æ–±—ä—è—Å–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏–ª–∏ –ø–æ–º–æ—á—å —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?",
  "session_id": "550e8400-e29b-41d4-a716-446655440000",
  "response_time_ms": 456
}
```

### –ü—Ä–∏–º–µ—Ä 2: –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ (—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º)

```bash
curl -X POST http://localhost:3000/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö?",
    "session_id": "550e8400-e29b-41d4-a716-446655440000"
  }'
```

–û—Ç–≤–µ—Ç:
```json
{
  "message": "–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ endpoint `/api/query`. –ü—Ä–æ—Å—Ç–æ –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä: '–°–∫–æ–ª—å–∫–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±—ã–ª–æ –≤ 2024 –≥–æ–¥—É?' –∏–ª–∏ '–ü–æ–∫–∞–∂–∏ —Ç–æ–ø 10 –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π'. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å –∏ –≤–µ—Ä–Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã! üìä",
  "session_id": "550e8400-e29b-41d4-a716-446655440000",
  "response_time_ms": 312
}
```

### –ü—Ä–∏–º–µ—Ä 3: –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫

```bash
curl -X POST http://localhost:3000/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "Hello! What can you do?",
    "session_id": "new-session-123"
  }'
```

### –ü—Ä–∏–º–µ—Ä 4: –ö–∞–∑–∞—Ö—Å–∫–∏–π —è–∑—ã–∫

```bash
curl -X POST http://localhost:3000/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "–°”ô–ª–µ–º! –°–µ–Ω –Ω–µ —ñ—Å—Ç–µ–π –∞–ª–∞—Å—ã“£?",
    "session_id": "kazakh-session-456"
  }'
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –±–æ—Ç–æ–º

–î–ª—è Telegram –±–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `chat_id` –∫–∞–∫ `user_id` –∏ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ `session_id` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```python
# –ü—Ä–∏–º–µ—Ä –¥–ª—è Telegram –±–æ—Ç–∞
session_id = user_sessions.get(chat_id, None)
response = requests.post(
    "http://localhost:3000/api/chat",
    json={
        "message": user_message,
        "session_id": session_id or "",
        "user_id": str(chat_id)
    }
)
data = response.json()
user_sessions[chat_id] = data["session_id"]  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
bot.send_message(chat_id, data["message"])
```

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ú–∞–∫—Å–∏–º—É–º 10 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
- –°–µ—Å—Å–∏–∏ —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞: ~512 —Ç–æ–∫–µ–Ω–æ–≤

## –û—Ç–ª–∏—á–∏—è –æ—Ç `/api/query`

| `/api/query` | `/api/chat` |
|--------------|-------------|
| –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç SQL –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ | –û–±—ã—á–Ω–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–±—â–µ–Ω–∏–µ |
| –ù–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ | –ï—Å—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç (—Å–µ—Å—Å–∏–∏) |
| –¢–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å—ã –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö | –õ—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã |
| –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç |

## –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ session_id**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω `session_id` –¥–ª—è –≤—Å–µ–≥–æ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ user_id**: –î–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Telegram chat_id)
3. **–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ —Å /api/query**: –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/api/query`, –¥–ª—è –æ–±—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ - `/api/chat`
4. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏**: –ï—Å–ª–∏ —Å–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞, —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é (–æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å –±–µ–∑ `session_id`)

